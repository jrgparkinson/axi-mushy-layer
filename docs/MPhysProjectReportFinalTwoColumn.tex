%\documentclass[11pt]{proc}
\documentclass[11pt,twocolumn]{article}

\usepackage{graphicx}

\usepackage{subcaption}
\usepackage{epstopdf}
\usepackage{float}
\usepackage{pgfplots}
\usepackage[export]{adjustbox}


\usepackage{hyperref}
\usepackage{cleveref}

\usepackage[round]{natbib}

\usepackage{verbatim}

\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{esint}
\usepackage{mathrsfs}
\usepackage{xfrac}
\usepackage{tabularx}

\usepackage{geometry}

\usepackage[titletoc]{appendix}

\usepackage{subeqnarray}

\usepgfplotslibrary{external} 
\tikzexternalize[prefix=./figures/]

\graphicspath{ {./figures/} }

\renewcommand{\sectionautorefname}{\S}
\renewcommand{\subsectionautorefname}{\S}

\newcommand{\St}{\mathscr{S}}
\newcommand{\CompRatio}{\mathscr{C}}

\newcommand{\crefrangeconjunction}{--}

\newcommand{\squeezeup}{\vspace{-5mm}}
\newcommand{\squeezeupsmall}{\vspace{-2.5mm}}

\usepackage[compact]{titlesec}  
%\titlespacing{\section}{8pt}{10pt}{8pt}

\usepackage[labelformat=simple]{subcaption}
\renewcommand\thesubfigure{(\alph{subfigure})}

\captionsetup[figure]{skip=4pt}

\makeatletter
\newcommand{\specialnumber}[1]{%
  \def\tagform@##1{\maketag@@@{(\ignorespaces##1\unskip\@@italiccorr#1)}}%
}
\newcommand{\specialeqref}[2]{\begingroup
  \def\tagform@##1{\maketag@@@{(\ignorespaces##1\unskip\@@italiccorr#2)}}%
  \eqref{#1}\endgroup}
\makeatother

\addtolength{\topmargin}{-.4in}
\addtolength{\bottommargin}{-.875in}


\begin{document}

\bibliographystyle{plainnat}

%set the line spacing, 13pt is the minimum allowed
\setlength{\baselineskip}{13pt}

%use one column for the title page
\onecolumn

\begin{comment}
%remove the page number from the title page
\clearpage
\thispagestyle{empty}
Candidate number: ... \\
Project number : AO04 \\
Project Title: The seeds of “brinicles”: flow and pattern formation in sea ice and mushy layers \\
The supervisor`s name: Dr A Wells and Dr D Rees-Jones \\
Word count: ...

%start the actual report
%\newpage

\end{comment}

\twocolumn

%set this as page 1
\setcounter{page}{1}

\twocolumn[
  \begin{@twocolumnfalse}
\begin{center}
\huge \textbf{The seeds of `brinicles': flow and pattern formation in sea ice and mushy layers} \normalsize
\end{center}
\squeezeup
\begin{abstract}
During the growth of young sea ice a porous mushy layer forms, consisting of ice crystals bathed in liquid brine, within which convection drives salt fluxes between the ice and the ocean. For a sufficiently large Rayleigh number, channels of liquid brine form within the mushy layer as part of buoyancy-driven convection cells. In contrast to previous studies, which consider a two dimensional planar geometry, I present a model for an axisymmetric cylindrical convection cell which has more physical relevance to sea ice. In doing so I introduce a number of novel simplifying assumptions and methods. In particular, the numerical scheme is implemented on a fixed grid, whilst the free boundary between the brine channel and mushy layer is determined by extrapolation. The behaviour of the system is investigated across a range of Rayleigh numbers and for different sizes of convection cell. In particular, conditions for the presence of brine channels and measures of the magnitude of convection are determined. Comparisons are made with the results of other studies, including a theoretical axisymmetric model and numerical planar models, all of which agree with the observed salt flux parametrizations for large Rayleigh numbers ($50 < Rm < 75$). An instability in the numerical method prevents the resolution of steady states at low Rayleigh numbers ($Rm\sim15$), where differences are expected to occur between flow in the two geometries. It is suggested that implementing a more stable method for determining the size of the brine channel may enable future models to overcome this difficulty.
\end{abstract}
  \end{@twocolumnfalse}
  ]
  
  

\section{Introduction}
\label{sec:intro}
Between 1978 and 2014 the September minimum of Arctic sea ice extent fell by 40.2\%~\citep*{fetterer-02}. Over the same time period, the March maximum extent fell by only 8.7\% and, consequently, a greater area of the Arctic ocean is being refrozen each year. It is therefore of increasing importance that the processes involved in the formation of new sea ice are well understood, such that they can be accurately incorporated into general circulation models. 

In the presence of a cold atmosphere, sea ice forms on the surface of the ocean. This ice is a reactive porous medium consisting of solid ice crystals of low salinity surrounded by an interstitial highly-saline fluid, or brine; such a composite mixture is referred to as a mushy layer. When the mushy layer is cooled the ice crystals grow, reducing the volume occupied by the brine and therefore increasing its salinity. Therefore the salinity is greatest where the temperature is coldest, at the top of the mushy layer, and decreases towards the ocean at the bottom. This gradient drives convection; the super-saline liquid sinks, being replaced by the more buoyant and relatively fresh ocean water. 

A sinking brine parcel has a greater salinity and lower temperature than the local equilibrium. The diffusion of salt is a significantly slower process than the diffusion of heat~\citep*{worster-97}, so local equilibrium is recovered by the melting of ice crystals. The resulting increase in the local liquid volume decreases salinity, whilst the latent heat supplied to melt the solid phase causes cooling. Conversely, rising ocean water is less saline and warmer than its environment and leads to freezing in the mushy layer. Permeability increases as local solid fraction decreases, so is greater where the flow is downward and reduced where the flow is rising. A larger permeability in the downward region permits a stronger flow, which in turn leads to greater melting and eventually the formation of entirely liquid channels, or `chimneys', into which the flow of brine out of the mushy layer is focussed. This process is illustrated in figure~\ref{subfig:convection-in-sea-ice}.

Drainage of brine from sea ice increases the salinity and density of the ocean below. This is known to have an effect on the large scale ocean circulation \citep*{brandon-et-al-10}, whilst the physical properties of the newly formed sea ice are dependant on the quantity of interstitial brine that remains \citep*{petrich-eicken-10}. There are other process through which desalination of sea ice can occur, however a review by \citet*{notz-worster-09} concluded that the only significant process in the winter freezing season (October - March) is buoyancy-driven convection. 

Strong salt fluxes attributed to convection have been observed in the Arctic Ocean \citep*{wettlaufer-et-al-00} and the dense, cold, plumes emanating from them have recently been captured on camera in the Antarctic Ocean~\citep[2011]{frozen-planet-11}. These processes have been reproduced using analogous binary mixtures. For example,~\citet*{wettlaufer-et-al-97} studied NaCl-water solutions cooled from above, whilst several studies have considered $\textrm{NH}_4\textrm{Cl}$-water solutions in which $\textrm{NH}_4\textrm{Cl}$ crystals are formed at the cooled base of a tank. A detailed review of these experiments is presented in~\citet*{zhong-et-al-12}.


\begin{figure*}[t]
\centering
\captionsetup[subfigure]{position=top,singlelinecheck=off,justification=raggedright, aboveskip=-12pt,belowskip=0pt}
\begin{subfigure}[t]{.55\linewidth}
    \centering
    \caption{}
    \includegraphics[width=\linewidth]{convection-in-sea-ice.pdf}
    
    \label{subfig:convection-in-sea-ice}
\end{subfigure}
\quad
\captionsetup[subfigure]{ aboveskip=4pt}
\begin{subfigure}[t]{.36\linewidth}
   \centering
   \caption{}
    \includegraphics[width=0.9\linewidth, right]{mushy-layer-chimneys-photo-schulze-worster.jpg}
    
    \label{subfig:schulze-worster-photo}
\end{subfigure}

\caption{~\subref{subfig:convection-in-sea-ice} Summary of steady state buoyancy-driven convection during the formation of sea ice with fully developed chimneys. Thick arrowed lines are streamlines of fluid flow, which circulate from the underlying ocean through the porous ice and out of the chimneys. The grey circles on the right represent ice crystals, illustrating the reduced permeability at the top of the mushy layer. Temperature, $T$, and salinity, $C$, are both indicated.~\subref{subfig:schulze-worster-photo} Photograph of $\textrm{NH}_4\textrm{Cl}$ directional solidification. Notice the formation of narrow, roughly straight sided, chimneys, and also that, apart from where the chimneys meet the liquid phase, the mush-liquid boundary is roughly flat. Taken from Schulze \& Worster (1998), but reflected in the horizontal plane to conform with the orientation of sea ice.}

\setlength{\belowcaptionskip}{0pt} % make text closer to caption

 \label{fig:overview-diagram-photo}

\end{figure*}


An alternative approach studies convection over a wide range of parameters using numerical models, although solving the full problem in this way is both theoretically and computationally cumbersome. Therefore, motivated by experimental observations and a desire for mathematical tractability, a variety of assumptions and simplifications must be introduced. A brief overview of the existing literature is given below, whilst the methods most relevant to this study are described in greater detail in~\autoref{sec:problem-formulation}.

%whilst more details are provided in~\autoref{sec:problem-formulation} in parallel with a description of the approximations made in this paper.

~\citet*{schulze-worster-98} considered a two-dimensional planar arrangement, in which both the chimney wall and the mush-ocean boundary were modelled as straight sides (figure~\ref{fig:arrangement}). Such an approximation is consistent to first order with experiment, as illustrated in figure~\ref{subfig:schulze-worster-photo}, and is ultimately the same approach that I will take.~\citet*{chung-worster-02} also solved numerically for a viscous flow in the liquid region, allowing them to apply jump conditions across the mush-liquid boundaries and hence resolve their shape. This approach confirmed that a straight sided chimney is a good approximation near the mush-ocean boundary, but less accurate away from ocean where the chimney width can decrease to $0$. Solving for the flow in the liquid region is computationally expensive. Therefore more recent studies \citep*{wells-et-al-10, wells-et-al-13} have combined the Schulze \& Worster approach to the mush-liquid boundary with Chung \& Worster's treatment of the chimney wall. 

All these studies are based on a two dimensional planar model and, as shown by~\citet*{rees-jones-worster-13}, axisymmetric convection displays important qualitative differences. For example, salt flux strongly depends on the far field ocean temperature in axisymmetry but does not in a planar geometry. Moreover,~\citet*{rees-jones-worster-13} also demonstrated that full three dimensional convection could be reasonably approximated by an axisymmetric arrangement. Their results were obtained by constructing a simple model which, through a similarity solution, reduced to a system of ordinary differential equations. In order to test the robustness of their conclusions, I construct a full numerical model for convective flow through brine channels in an axisymmetric geometry. For simplicity, I apply Schulze \& Worster's assumptions of a straight sided chimney and flat mush-ocean boundary and focus on solutions with no azimuthal variation.

The derivation of the governing equations and boundary conditions is presented in~\autoref{sec:problem-formulation}. In~\autoref{sec:computational-procedure} I describe the numerical methods used to solve the problem and how the solution has been verified. Steady states are then found for a range of parameters, and the results of these simulations are presented and discussed in~\autoref{sec:results}. Finally, I conclude in~\autoref{sec:conclusion}.

\section{Problem formulation}
\label{sec:problem-formulation}

\begin{figure*}[t]
       \centering
        \includegraphics[width=\textwidth]{simplified-arrangement}
        \setlength{\belowcaptionskip}{0pt} % make text closer to caption
        
       \caption{Simplified mushy layer geometry (left) showing a radial cross section of an axisymmetric annular region. Dashed lines show the geometry of the full non-linear problem, for comparison. At the top of the convection cell, the mushy layer is at the eutectic temperature - the point where, for any liquid concentration, the binary mixture forms an impermeable solid. This can be seen in the phase diagram (right) where the thick black line illustrates the path taken by a fluid parcel as it is cooled from the ocean to the eutectic solid, under the assumption that it is always in thermodynamic equilibrium.}
    \label{fig:arrangement}
\end{figure*}

I consider steady state convection in a cylindrical region of a mushy layer with a chimney at the centre, as shown in figure~\ref{fig:arrangement}. The chimney is centred on $r=0$ and has radius $a$, whilst the full convection cell has radius $R$ and height $H$. At the top of the mushy layer is a region of ice at or below the eutectic temperature, $T_E$, which is defined as the point at which the binary mixture becomes impermeable for all values of the solute concentration $C$. In line with the previous studies mentioned in~\autoref{sec:intro}, this region is assumed to grow downwards at a constant rate $V$. Although this is not truly representative of sea ice, where the growth rate decreases as freezing progresses, it is a simplifying assumption that allows for steady state solutions. The reference frame is chosen so that the origin remains fixed at the base of the eutectic solid. From this perspective, the mushy layer is pulled upwards between two fixed heat exchangers at the growth rate, $V$.

Following previous authors, I assume that the mushy layer is ideal \citep*{worster-97}. Within this assumption, the temperature $T$ and solute concentration, or salinity, $C$ are in local thermodynamic equilibrium and obey a linear liquidus relationship

\begin{equation}
\label{eq:liquidus}
T = T_L(C) = T_E  - \Gamma (C-C_E) \;
\end{equation}
where $\Gamma$ is the slope of the liquidus. The ocean is assumed to have constant salinity $C_0$ and the temperature at the mush-liquid boundary is therefore given by $T_0 = T_L(C_0)$. The far field temperature in the ocean is $T_\infty$.

\subsection{Governing equations}
Flow in an ideal mushy layer is governed by Darcy's equation for flow in a porous medium, and is assumed to be incompressible:
%\begin{equation}
%\label{eq:darcys-eqn}
 %\mathbf{u} = \frac{\Pi}{\mu} (- \nabla p + \rho \mathbf{g}); \hspace{15ex} \nabla \cdot \mathbf{u} = 0,
%\end{equation}

%\newcolumntype{R}{>{\raggedleft\arraybackslash}X}
  \begin{equation}
  \specialnumber{a,b} \label{eq:darcys-eqn-incompressible} 
  \mathbf{u} = \frac{\Pi}{\mu} (- \nabla p + \rho \mathbf{g}),  \qquad  \nabla \cdot \mathbf{u} = 0,
  \end{equation}
where $\mathbf{u}$ represents the flux of the interstitial fluid relative to the solid phase, known as the Darcy velocity. I have also introduced the permeability $\Pi$, pressure $p$, dynamic viscosity $\mu$, density $\rho$ and gravitational acceleration $\mathbf{g}$. In line with previous studies~\citep*{schulze-worster-98,chung-worster-02} I consider the permeability to be of the form $\Pi = \Pi_0 (1-\phi)^3$, where $\phi$ is the local volume fraction of the solid phase. The density depends on the temperature and salinity through the equation of state, which is linearised to yield
\begin{equation}
\label{eq:eqn-of-state}
\rho = \rho_0 \left[1-\alpha (T-T_0) + \beta (C-C_0) \right],
\end{equation}
where $\rho_0$ is a constant reference density, $\alpha$ is a constant thermal expansion coefficient, and $\beta$ a corresponding constant haline coefficient. Equation~\eqref{eq:eqn-of-state} can be written as a function of $C$ only using the liquidus relationship~\eqref{eq:liquidus} and, upon substitution into equation~\specialeqref{eq:darcys-eqn-incompressible}{a}, it is found that
\begin{equation}
\label{eq:darcys-equation-T}
\mathbf{u} =- \frac{\Pi}{\mu} (\nabla P + \rho_0 g \Gamma^* \mathbf{\hat{z}} (C-C_0) ),
\end{equation}
where $\Gamma^* =  \alpha \Gamma + \beta$ and $P = p + \rho_0 gz$ is the modified pressure. Conservation of heat is determined by
\begin{equation}
\label{eq:heat-conservation}
\left( \frac{\partial}{\partial t} + V\frac{\partial}{\partial z}\right) T + \mathbf{u} \cdot \nabla T = \kappa \nabla^2 T  + \frac{L}{c_p} \left( \frac{\partial}{\partial t} + V\frac{\partial}{\partial z} \right) \phi \; , 
\end{equation}
where $L$ the latent heat of fusion per unit mass, $c_p$ the specific heat capacity and the additional $z-$derivatives are due to the choice of a reference frame moving at $V\mathbf{\hat{z}}$. In addition to the expressions for advection and diffusion, the final term represents the latent heat released during the formation of ice crystals within the mushy layer.

Finally, conservation of solute is given by
\begin{equation}
\label{eq:solute-conservation}
\left( \frac{\partial}{\partial t} + V\frac{\partial}{\partial z}\right) \left[ (1-\phi) C + \phi C_s \right] + \mathbf{u} \cdot \nabla C =  0 \; ,
\end{equation}
where the solute concentration in the solid phase is denoted by $C_s$ and therefore $(1-\phi) C + \phi C_s$ is the volume weighted average concentration. Heat diffusion is a much faster process than solute diffusion, so solute transport is assumed to proceed solely through advection, hence the lack of a diffusion term.

\subsection{Non-dimensionalisation and scaling approximations}
\label{sec:approximations}
Non-dimensional temperature $\theta$ and solute concentration $\Theta$ are defined by
\begin{equation}
\specialnumber{a,b}
\theta = \frac{T-T_0}{\Delta T}, \hspace{15ex} \Theta = \frac{C-C_0}{\Delta C},
\end{equation}
where $\Delta T = T_0 - T_E$ and $\Delta C = C_E - C_0$. Using the liquidus relationship~\eqref{eq:liquidus}, it is possible to see that $\theta = - \Theta$ in the mushy layer. Equations~\eqref{eq:darcys-equation-T}--~\eqref{eq:solute-conservation} can be non-dimensionalised by scaling velocities with $V$, lengths with $\kappa/V$, time with $\kappa/V^2$, permeability with $\Pi_0$ and pressure with $\rho_0 g \Gamma^* \Delta C \kappa / V$. Using primes to denote dimensionless quantities, this gives
\begin{equation}
\specialnumber{a,b} \label{eq:darcy-mass-dimless}
\mathbf{u'} = Rm \, \Pi' \left(-\nabla' P' + \theta \mathbf{\hat{z}} \right),  \qquad \nabla' \cdot \mathbf{u'} = 0,
\end{equation}
\begin{eqnarray}
\left( \frac{\partial}{\partial t'} + \frac{\partial}{\partial z'}\right) \theta + \mathbf{u'} \cdot \nabla' \theta &=& \nabla'^2 \theta  + \St \left( \frac{\partial}{\partial t'} + \frac{\partial}{\partial z'} \right) \phi,  \label{eq:heat-conservation-dimless} \\
\left( \frac{\partial}{\partial t'} + \frac{\partial}{\partial z'}\right) \left[ (1-\phi) \theta - \phi \CompRatio \right] + \mathbf{u'} \cdot \nabla \theta &=&  0, \label{eq:solute-conservation-dimless}
\end{eqnarray}
where I have introduced the Rayleigh number in the mushy layer $Rm$, Stefan number $\St$, concentration ratio $\CompRatio$ and will later use the dimensionless far field temperature $\theta_\infty$.
\begin{equation}
\specialnumber{a,b,c,d}
Rm = \frac{\Pi \rho_0 g \Gamma^* \Delta C}{\mu V}, \hspace{7ex} \St = \frac{L}{c_p \Delta T}, \hspace{7ex} \CompRatio = \frac{C_s - C_0}{\Delta C}, \hspace{7ex} \theta_\infty = \frac{T_\infty - T_0}{\Delta T}.
\end{equation}
%See Worster 97p.102 for description of these constants
The Rayleigh number quantifies the strength of the buoyancy force relative to viscous dissipative forces in the mushy layer; it is the primary measure of the strength of convection. The Stefan number is the ratio between the latent heat released upon solidification and the heat that must be extracted to cool a liquid parcel from $T_0$ to $T_E$. Because heat diffusion occurs quicker than salt diffusion, the rate of solute transport governs the rate of phase change; this is characterised by the concentration ratio. As $\Delta C$ drives the transport of solute, when $\CompRatio$ is large the rate of phase change is slow. For the remainder of this work I will drop the primes, and all quantities, unless otherwise stated, are non-dimensional. I will also employ a subscript notation for partial derivatives.
% In this case $\St$ is large so, as $\Delta T$ drives the heat transport across the mushy layer, the phase boundary with the eutectic solid can be considered as static relative to heat transfer across it.

Following~\citet*{rees-jones-worster-13} I assume that $\CompRatio \gg 1$. In this limit, the equation for solute conservation~\eqref{eq:solute-conservation-dimless} reduces to
\begin{equation}
\phi_t + \phi_z = \frac{ \mathbf{u} \cdot \nabla \theta}{\CompRatio} + O\left(\frac{1}{\CompRatio}\right).
\end{equation}
From the momentum equation~\specialeqref{eq:darcy-mass-dimless}{a}, $\mathbf{u} \cdot \nabla \theta \sim Rm$, so making the further assumption that $Rm \ll \CompRatio$ results in $\phi \ll 1$ and therefore $\Pi = \Pi_0(1-\phi)^3 = \Pi_0$. A second consequence of this result is that, after also assuming that $\St \ll \CompRatio$, the heat equation simplifies to
\begin{equation}
\label{eq:heat-psi}
r \theta_t + r \theta_z - \psi_z \theta_r + \psi_r \theta_z = (r \theta_r)_r + r \theta_{zz},
\end{equation}
where a Stokes streamfunction $\psi = (-\psi_z/r, \psi_r/r)$ that satisfies mass conservation~\specialeqref{eq:darcy-mass-dimless}{b} has been introduced. This is a crucial simplification because it uncouples the temperature and solid fraction. Taking the curl of the momentum equation~\specialeqref{eq:darcy-mass-dimless}{a} eliminates the pressure term, leaving the vorticity equation
\begin{equation}
\label{eq:momentum-simplified}
(\psi_r/r)_r + \psi_{zz}/r = Rm \, \theta_r \; .
\end{equation}

Equations~\specialeqref{eq:darcy-mass-dimless}{a,b},~\eqref{eq:heat-psi} and~\eqref{eq:momentum-simplified} govern the evolution of $\theta$ and $\psi$ in the mushy layer, subject to the boundary conditions which will be derived in the next section.

\subsection{Boundary conditions}
\begin{figure*}[ht!]
    \centering 
    \squeezeup
       \includegraphics[width=0.85\textwidth]{boundary-conditions}
       
       \setlength{\belowcaptionskip}{-10pt} % make text closer to caption
       
       \caption{Summary of the governing equations and boundary conditions, as derived in~\autoref{sec:problem-formulation}.}
    \label{fig:boundary-conditions}
\end{figure*}


The full set of equations and boundary conditions are summarised in figure~\ref{fig:boundary-conditions}, and derived below. At the solid-mush boundary $(z=0)$ the temperature and concentration are fixed at their eutectic values so $\theta = -1$. The constraint that there is no normal flow into the solid ensures that $\psi_r = 0$, which we satisfy by setting $\psi = 0$ along the boundary.

At the edge of the cylindrical region $(r=R)$ the conditions of no normal flow or heat flux require that $\theta_r=0$ and $\psi_z=0$. The latter condition is again satisfied by setting $\psi = 0$ along the boundary.

At the mush-ocean boundary $(z=-H)$ the temperature and concentration are fixed at $T_0$ and $C_0$, so $\theta=0$.~\citet*{emms-fowler-94} have shown that there is approximately constant dynamic pressure along the boundary, so the momentum equation~\specialeqref{eq:darcy-mass-dimless}{a} gives the condition $\psi_z = 0$. 

\subsubsection{The chimney}
At the middle of the chimney $(r=0)$ the conditions that $\psi$ and $u_z$ must be continuous determine the boundary conditions 
\begin{equation}
\label{eq:axi-chimney-bcs}
\psi = 0, \hspace{5ex} (\psi_r/r)_r = 0,   \hspace{5ex} (r=0).
\end{equation}
To avoid solving numerically for the liquid flow inside the chimney, I follow previous authors~\citep*{schulze-worster-98,chung-worster-02,wells-et-al-10} and, adapting their method from a planar to an axisymmetric geometry, use the observation that chimneys are narrow compared to the full convection cell $(a\ll R)$ to analytically integrate from $r=0$ to $r=a$. 

For small $r$, the steady state of the axisymmetric heat conservation equation~\eqref{eq:heat-psi} is dominated by the $(r \theta_r)_r$ term. Therefore the leading order approximation to $\theta$ must not depend on $r$, so I expand
\begin{equation}
\label{eq:theta-approx}
\theta(r,z) = \theta^0(z) + \theta^1(r,z), \hspace{5ex} \theta^1 \ll \theta^0.
\end{equation}
Using this, equation~\eqref{eq:heat-psi} can be integrated to give
\begin{equation}
\label{eq:theta-a-bc}
\psi_q \theta = a \theta_r   \hspace{5ex} (r=a),
\end{equation}
where $\psi_q = \psi + \frac{1}{2} r^2$ is the stream function for $\mathbf{q} = \mathbf{u} + \mathbf{V}$ and $\mathbf{V} =  \mathbf{\hat{z}}$ after being non-dimensionalised.

The Navier-Stokes equation in the chimney simplifies to the Stokes equation, after making the additional assumption that $a \ll H$, for which the $z$-component is
\begin{equation}
\label{eq:stokes-channel}
\nabla^2 (\psi_r/r) \approx \frac{Rm}{Da} \left(P_z + \Theta \right), \quad \text{ and } \nabla^2 \approx (r \partial_r)_r/r,
\end{equation}
where $Da=\Pi_0 V^2 / \kappa^2$ is the Darcy number. In the same limit, the pressure within the chimney is independent of $r$ \citep*{schulze-worster-98}.

Motivated by the observation that the solute concentration within the chimney is roughly a linear function of $z$~\citep*{rees-jones-worster-13}, I make a simplifying approximation that
\begin{equation}
\Theta = \Theta(z) = 1 + \frac{z}{2H},
\end{equation}
and then integrate equation~\eqref{eq:stokes-channel} three times with respect to $r$ within the chimney. Applying the boundary conditions~\eqref{eq:axi-chimney-bcs}, I obtain an expression for $\psi$ on the mush-chimney boundary,
\begin{equation}
\psi = \frac{a^4}{16 Da} \left(\frac{\psi_r}{a} + Rm \left[ \theta -  \left( 1 + \frac{z}{2H} \right) \right] \right)   + \frac{1}{2} a \psi_r   \hspace{5ex} (r=a),
\end{equation}
where the momentum equation~\specialeqref{eq:darcy-mass-dimless}{a} has been used to replace the pressure term.

\subsection{Patching equations}
\label{sec:patching-equations}
The chimney wall is a free boundary whose position is determined by relaxing $a$ to satisfy a constraint of marginal equilibrium (see~\autoref{sec:free-boundaries-theory} and ~\autoref{sec:free-boundary-method} for more details). To avoid having to remap the computational domain at each time step, an artificial boundary is introduced at $r=b$, where $b > a$ but $(b-a) \ll a$. In other words, $b$ is only slightly greater than $a$. The computational grid is then restricted to $b < r < R$. 

The boundary conditions at $r=b$ are found by integrating analytically across the small region of the mushy layer $a < r < b$. The heat equation takes the same form in the liquid and the mushy layer, so the first boundary condition follows as the generalisation of~\eqref{eq:theta-a-bc}. With $b$ replacing $a$,
\begin{equation}
\psi_q \theta = b \theta_r  \hspace{5ex} (r=b).
\end{equation}
The vorticity equation~\eqref{eq:momentum-simplified} in the region $a < r < b$ is well approximated by
\begin{equation}
\label{eq:psi-patch-eq}
(\psi_r/r)_r \approx -Rm \theta_r,
\end{equation}
Taylor expanding~\eqref{eq:theta-approx} about $r=b$ gives the first order approximation $\theta(r, z) \approx \theta(b, z) - (b-r) \theta_r(b, z)$. Applying this approximation in~\eqref{eq:psi-patch-eq}, integrating twice with respect to $r$, and imposing the continuity conditions across the $r=a$ boundary; $[\psi(a)]_{-}^{+} = 0$ and $[\psi_r(a)]_-^+ = 0$, results in
\begin{equation}
  \psi = \frac{1}{2} b \psi_r + \frac{a^4}{16 Da} \left(  \frac{\psi_r}{b}  +   Rm \left[ \theta - \left( 1 + \frac{z}{2H} \right) \right]  \right)  + \frac{1}{6} (b^3-a^3) Rm \, \theta_r \hspace{5ex} (r=b).
\end{equation}

\subsection{Free boundaries}
\label{sec:free-boundaries-theory}

The full problem of steady state convection in a mushy layer, as shown in figure~\ref{fig:arrangement}, has two free boundaries which need to be determined; the chimney wall and mush-ocean interface. Whilst in reality both of these boundaries are curves, I make the simplifying assumption that they are straight sided and therefore only have to solve for their position. A known problem with this approximation for the mush-ocean boundary is that it introduces a singularity at the point where the chimney and ocean meet, but this issue appears to remain localised~\citep*{schulze-worster-98} so is accepted as a necessary compromise.

The mush-ocean boundary is treated in a subtly different way to previous authors.~\citet*{schulze-worster-98} have shown, by balancing advection and diffusion across a thermal boundary layer in the ocean, that the temperature gradient at this boundary is related to the far field temperature by
\begin{equation}
\label{eq:mush-ocean-bc}
\theta_z = - \theta_\infty \, \mathbf{q} \cdot \mathbf{\hat{z}} = - \theta_\infty (\psi_r/r + 1) \hspace{5ex} (z=-H).
\end{equation}
Instead of fixing $\theta_\infty$ and using this condition to determine $z=H$, I instead fix $H$ and then calculate the corresponding $\theta_\infty$ from the resulting steady state. This approach removes the need to adjust the boundary at each time step, simplifying the model and reducing the runtime.

The same approach cannot be taken at the chimney wall, as it is not related to another parameter in the way that $\theta_\infty$ and $H$ are coupled. To determine the position of this free boundary I implement the results of~\citet*{schulze-worster-99} who showed, through thermodynamic considerations and the requirement that the solid fraction must be positive in the mushy layer, that  
\begin{equation}
\label{eq:chimney-bc}
\mathbf{q} \cdot \nabla \theta = 0 \hspace{5ex} ( r=a(z) ).
\end{equation}
This condition is implemented via relaxation, as described in~\autoref{sec:free-boundary-method}.

\section{Computational procedure}
\label{sec:computational-procedure}


\begin{figure*}[t!]
\captionsetup[subfigure]{position=top,singlelinecheck=off,justification=raggedright, aboveskip=-12pt,belowskip=0pt}
\begin{subfigure}[t]{.48\linewidth}
	\centering
	\caption{}
	\newlength\figureheight 
	\newlength\figurewidth 
	\setlength\figureheight{4cm} 
	\setlength\figurewidth{6cm}
	\input{heated-wire-error.tikz}
	\label{subfig:heated-wire-error}
\end{subfigure}
\quad
\captionsetup[subfigure]{aboveskip=-6pt}
\begin{subfigure}[t]{.48\linewidth}
	\centering
	\caption{} 
	%\includegraphics[width = \textwidth]{HRL-Nu-comparison}
	\setlength\figureheight{4cm} 
	\setlength\figurewidth{6cm}
	\input{HRL-Nu-comparison.tikz}
	\label{subfig:HRL-Nu-comparison}
\end{subfigure}

\setlength{\belowcaptionskip}{-7pt} % make text closer to caption

\caption{~\subref{subfig:heated-wire-error} The linear relationship between the average fractional error $\left<\Delta T/T_{analytic} \right>$ and $(\Delta r)^2$ is confirmed as a benchmark test of the second order method.~\subref{subfig:HRL-Nu-comparison} The problem of convection in a 2-D planar porous layer heated from below was solved as a further test of the code; here I plot $Nu(Rm)$. The well documented onset of convection was observed at $4 \pi^2$, and the calculated values (blue crosses) were in good agreement with those of~\citet*{caltagirone-75} (red circles).}
\label{fig:code-verification}
\end{figure*}

The equations governing $\theta$ and $\psi$ within the mushy layer were solved using semi-implicit timestepping and second order finite differences in space on a fixed grid using iterative methods. The momentum equation~\eqref{eq:momentum-simplified} was solved by successive over-relaxation (SOR)~\citep*{young-50}, whilst the time dependent heat equation~\eqref{eq:heat-psi} was solved using an Alternating Direction Implicit (ADI) method~\citep*{peaceman-rachford-55} which ensures second order temporal accuracy. A steady state was deemed to have been reached once the time derivatives of $\theta, \psi$ and $a$ were all $< 10^{-5}$. The mixed and Neumann boundary conditions were enforced using a Taylor expansion centered on the grid point adjacent to the boundary in order to maintain second order finite differencing. Further details of the numerical method can be found in~\autoref{app:numerical-method}.

The numerical method was implemented in MATLAB, and the code was written in stages of increasing complexity in order to verify its accuracy. Similarity solutions for an axisymmetric heated wire are presented in ~\citet*[Chapter~5.9]{nield-bejan-06}, using which I verified second order convergence of my code when solving the system;
\begin{eqnarray}
&&(\psi_r/r)_r = -Rm \theta_r, \hspace{5ex} \psi_r \theta_z - \psi_z \theta_r = (r \theta_r)_r, \\
&&\theta = z, \hspace{5ex} u_r = 0 \hspace{5ex} (r=a), \\
&&\theta = 0, \hspace{5ex} u_z = 0 \hspace{5ex} (r=R),
\end{eqnarray}
as demonstrated in figure~\ref{subfig:heated-wire-error}. In order to test both the implementation of Neumann boundary conditions and the coupling of the heat and momentum equations, I also solved for convection in a 2-D planar porous layer heated from below~\citep*{horton-rogers-45,lapwood-48}. I observed the onset of convection at $Rm = 4 \pi^2$, and found my results for $Nu(Ra)$ to be in good agreement with those of~\citet*{caltagirone-75} over a wide range of $Rm$ (see figure~\ref{subfig:HRL-Nu-comparison}).

Finally, once the full set of boundary conditions for flow with brine channels were applied, the steady state solutions were checked to ensure both the interior equations and boundary conditions were satisfied.

\subsection{Free boundaries}
\label{sec:free-boundary-method}

\begin{figure*}[t!]
\centering
\captionsetup[subfigure]{position=top,singlelinecheck=off,justification=raggedright, aboveskip=-12pt,belowskip=0pt}
\begin{subfigure}[t]{.54\linewidth}
       	\centering
       	 \caption{}
       	%\includegraphics[width=\textwidth]{q-dot-grad-theta}
       	\setlength\figureheight{5cm} 
	\setlength\figurewidth{7cm}
	\input{q-dot-grad-theta.tikz}
       	\label{subfig:q-dot-grad-theta}
\end{subfigure}
\quad
\captionsetup[subfigure]{aboveskip=-18pt}
\begin{subfigure}[t]{.42\linewidth}
       	\centering
        	\caption{}
      	% \includegraphics[width=\textwidth]{q-dot-grad-theta-root}
      	\setlength\figureheight{5cm} 
	\setlength\figurewidth{4cm}
	\input{q-dot-grad-theta-root.tikz}
    	\label{subfig:q-dot-grad-theta-root}
\end{subfigure}

\setlength{\belowcaptionskip}{-7pt} % make text closer to caption

\caption{~\subref{subfig:q-dot-grad-theta} Cross section of $\mathbf{q} \cdot \nabla \theta$, taken at $z=-2H/3$. The full curve is plotted in the top right corner, with the region in the dashed box magnified to produce the main plot. Dashed red lines are linear extrapolations from two points on the curve separated by $\Delta r = 0.04R$. The large variation in the roots of these extrapolations illustrates the sensitivity of this method, which makes it infeasible.~\subref{subfig:q-dot-grad-theta-root} $ \left. \mathbf{q} \cdot \nabla \theta \right|_{r=a}$ calculated for steady state solutions with $a=b$. The negative gradient at the root $ \left. \mathbf{q} \cdot \nabla \theta \right|_{r=a} = 0$ motivates the implementation of the relaxation method given in equation~\eqref{eq:relaxation-q-dot-grad-theta}. }
\label{fig:free-boundary-method}  

\end{figure*}

Implementing the condition of marginal equilibrium~\eqref{eq:chimney-bc} at the chimney wall posed significant difficulty. I chose to apply it at $z = - 2H/3$, where the straight sided approximation should be most accurate; near the solid-mush boundary the chimney width is observed to decrease and may in fact disappear altogether, whilst the singularity at the mush-ocean boundary means that the local values of $\theta$ and $\psi$ are unreliable. To enforce this condition, it is necessary to extrapolate from $r=b$ at each time step and then adjust $a$ appropriately. 

A first attempt was made using a linear extrapolation for $f(r) = \mathbf{q} \cdot \nabla \theta$,
\begin{equation}
f(a) = f(b) + (a-b) \left. \frac{\partial f}{\partial r}\right|_{r=b} \, ,
\end{equation}
and solving for the root $f(a)=0$ to find a new estimate for the chimney radius $a^*$. The chimney radius $a(t)$ was then updated by relaxing towards $a^*$,
\begin{equation}
\frac{da}{dt} = \lambda (a - a^*),
\end{equation}
with constant $\lambda$. However this produced an unstable scheme in which the chimney width often became zero, as the extrapolation was highly sensitive to the position of $b$ on the $\mathbf{q} \cdot \nabla \theta$ curve (see figure~\ref{subfig:q-dot-grad-theta}).

A more careful analysis revealed that, based on the form of $\psi$ and $\theta$ in the region $a < r < b$ derived in~\autoref{sec:patching-equations}, the Pad\'{e} approximation
\begin{equation}
\mathbf{q} \cdot \nabla \theta \approx \frac{c_1 r^3 + c_2 r^2 + c_3 r + c_4}{r}
\end{equation}
might be more appropriate for extrapolation, where $c_1, c_2, c_3$ and $c_4$ are fitted from data at the edge of the computational grid. However this too was found to be unstable, in this case due to the $1/r$ term causing the extrapolation to, in some cases, predict no roots at all. Removing the $1/r$ term and instead considering a quadratic function with $c_4=0$ was slightly more successful, but the predicted chimney radii $a^*$ were still highly dependant on the form of $\mathbf{q} \cdot \nabla \theta$ at $r=b$ and convergence to a steady state with chimneys could not be achieved.

By fixing $a=b$ and finding steady states at a range of chimney widths, I saw that $\left. \mathbf{q} \cdot \nabla \theta \right|_{r=a}$ approaches a root from above as $a$ increases (figure~\ref{subfig:q-dot-grad-theta-root}). This suggested a new relaxation scheme:
\begin{equation}
\label{eq:relaxation-q-dot-grad-theta}
\frac{da}{dt} = \lambda \left. \mathbf{q} \cdot \nabla \theta \right|_{r=a}
\end{equation}
where $\left. \mathbf{q} \cdot \nabla \theta \right|_{r=a}$ was calculated using a quadratic extrapolation from $r=b$, and the relaxation parameter $\lambda = 0.002$ was chosen empirically. Using this method it was possible to converge on a steady state with chimneys, so the description of the numerical scheme is complete.


\section{Numerical results and their interpretation}
\label{sec:results}

\begin{figure*}[t!]
\centering
\captionsetup[subfigure]{position=top,singlelinecheck=off,justification=raggedright, aboveskip=-14pt,belowskip=0pt}
\begin{subfigure}[t]{.48\linewidth}
	\centering
    	%\includegraphics[width=0.9\textwidth]{steady-state-Rm60H0-25R0-25}
   	\setlength\figureheight{5cm} 
	\setlength\figurewidth{6.5cm}
	\caption{}
	\input{steady-state-darcy.tikz}
    	\label{subfig:steady-state-darcy}
 \end{subfigure}
 \quad
 \begin{subfigure}[t]{.48\linewidth}
    	\centering
    	%\includegraphics[width=0.9\textwidth]{steady-state-Rm60H0-25R0-25-q}
    	\setlength\figureheight{5cm} 
	\setlength\figurewidth{6.5cm}
	\caption{}
	\input{steady-state-q.tikz} 
    	\label{subfig:steady-state-q}
 \end{subfigure}
 
 \setlength{\abovecaptionskip}{-10pt} % make caption closer to figure
\setlength{\belowcaptionskip}{-7pt} % make text closer to caption
 
 \caption{Steady state temperature and flow fields for $Rm=60, R=0.25, \theta_\infty=1.4, Da=5\times10^{-5}$. Coloured lines are contours of equal $\theta$, ranging from $\theta=-1$ at $z=0$ to $\theta=0$ at $z=-H$ in $0.1$ increments. Solid black lines are streamlines with $\psi_{(q)} = 0$ at $r=0$, increasing in steps of $0.004$. In~\subref{subfig:steady-state-darcy} the reference frame is fixed to the solid phase, and the streamlines shown are the Darcy velocity, $\mathbf{u}$. ~\subref{subfig:steady-state-q}  illustrates the problem in the laboratory reference frame, where the streamlines are calculated from $\mathbf{q} = \mathbf{u} + V \mathbf{\hat{z}}$. The red vertical line illustrates the position of the chimney wall, $a$.}
\label{fig:typical-steady-states}
 \end{figure*}


Obtaining a stable numerical integration requires $(b-a) \ll a$. This makes finding steady states for arbitrary parameters challenging, as a very good first guess for $a$ is required. An initial steady state was found for $Rm = 60, R=0.25, H=0.25, Da=5\times 10^{-5}$ by bracketing a root of $\left. \mathbf{q} \cdot \nabla \theta \right|_{r=a} = 0$, and parameters were then varied by small amounts ($\sim 1\%$ of their value) such that the previous value of $a$ was a good estimate for the new state. This allowed for a range of parameter space to be explored by parameter continuation, and in total $16\,200$ steady states were found. All calculations were performed on a $40\times40$ mesh, the accuracy of which was confirmed by mesh refinement; increasing the resolution to $60\times60$ for this initial steady state gave solute fluxes which differed by $0.7\%$.

A typical steady state is shown in figure~\ref{fig:typical-steady-states}, where the solution has been extended into $0 \le r \le b$ using the approximate analytical solutions derived in~\autoref{sec:approximations}. The singularity resulting from the straight mush-ocean boundary can be seen by its distorting effect on the streamlines at the chimney boundary. However the affected region is small relative to the whole domain, so should not affect the overall form of the solution. The parallel isotherms and streamlines at $(r, z) = (a, -2H/3)$ in figure~\ref{subfig:steady-state-q} confirm that the condition $\left. \mathbf{q} \cdot \nabla \theta \right|_{r=a} = 0$, used to determine the position of the chimney wall, is indeed satisfied. Comparison between figures~\ref{subfig:steady-state-darcy} and~\ref{subfig:steady-state-q} illustrates the difference between viewing the system in a frame of reference fixed to the solid-mush boundary~\ref{subfig:steady-state-darcy} and in laboratory frame~\ref{subfig:steady-state-q}. In the latter case, fluid parcels enter the solid with vertical velocity $V$, the solidification rate.

Comparing the relative magnitudes of $\mathbf{u}$ and $\theta$ in the steady state solution, I find that the pressure gradient in the mushy layer, as given by the momentum equation~\specialeqref{eq:darcy-mass-dimless}{a}, is dominated by the $\theta \mathbf{\hat{z}}$ term. Therefore it is well approximated by a purely vertical field. The temperature field is also predominantly vertical, except in the vicinity of the chimney where there is a significant horizontal gradient. Through the equation of state~\eqref{eq:eqn-of-state} it is clear that the liquid density is proportional to $\theta$, so there is a corresponding horizontal density gradient near the chimney which, when coupled with the vertical pressure gradient, leads to the non-uniform acceleration of fluid parcels which have different densities but experience the same pressure. This baroclinic torque generates vorticity $\omega = - \nabla^2 \psi$, as can be seen mathematically in equation~\eqref{eq:momentum-simplified}, and the resulting increase in vorticity drives convective fluid flow out of the mushy layer and into the chimney.

 
  \begin{figure*}[t!]
\centering
\captionsetup[subfigure]{position=top,singlelinecheck=off,justification=raggedright, aboveskip=-18pt,belowskip=0pt}
\begin{subfigure}[t]{.48\linewidth}
    \centering
    %\includegraphics[width=\textwidth]{Rm-a-H0-25R0-34}
    \setlength\figureheight{5cm} 
	\setlength\figurewidth{6.5cm}
	\caption{}
	\input{Rm-plot.tikz} 
    \label{subfig:Rm-plot}
 \end{subfigure}
 \quad
 \captionsetup[subfigure]{aboveskip=-11pt}
 \begin{subfigure}[t]{.48\linewidth}
    \centering
    \caption{}
    \setlength\figureheight{5cm} 
	\setlength\figurewidth{6.5cm}
	\input{R-plot.tikz} 
    \label{subfig:R-plot}
 \end{subfigure}
 
\setlength{\abovecaptionskip}{-10pt} % make caption closer to figure
\setlength{\belowcaptionskip}{-7pt} % make text closer to caption
 
 \caption{Plots illustrating the parameter dependence of the flow. Solid lines are average solute flux $F/R$ and relate to the right hand axis. All calculations were performed at $\theta_\infty=1.4$ and $Da = 5\times10^{-5}$. In~\subref{subfig:Rm-plot} the chimney radius, $a$, is also shown (dashed lines) and $Rm$ was varied for fixed $R^2=0.048, 0.68, 0.09$. Both solute flux and chimney width increase as the flow strength increases, whilst below a critical $Rm = Rm_c(R)$, the flow is insufficient to maintain a chimney. In~\subref{subfig:R-plot} the solute flux per convection cell $F$ is plotted (dashed lines), and increases monotonically with cell drainage area whilst the average solute flux has a maximum value at $R = R_c(Rm)$.}
 \label{fig:parameter-plots}
 \end{figure*}

To investigate the parameter dependence of the steady state solutions, $Rm$ and $R$ were varied at fixed $Da$, with $H$ being varied in order to maintain $\theta_\infty=1.4$ - a physically appropriate choice which is consistent with~\citet*{rees-jones-worster-13}. Figure~\ref{subfig:Rm-plot} illustrates how the chimney radius, $a$, and the solute flux from the mushy layer to the chimney, $F/R$, varies with the Rayleigh number. The solute flux has been averaged over the radius of the convection cell $R$ as it is the flux per unit length, not the flux per convection cell, that is of primary interest (see appendix~\ref{app:solute-flux} for full details of the calculation). We see that $F/R$ increases with $Rm$, as is expected given that $Rm$ is the primary measure of flow strength, and a stronger flow increases the flux into the chimney. A stronger flow also increases melting of the solid matrix along the chimney edge, so the chimney width increases with the Rayleigh number whilst, below a critical $Rm$ (illustrated by dotted lines), the flow is insufficiently strong to sustain a chimney. For large $Rm$ the chimney width stops increasing and even starts to decrease slightly, although this is difficult to see in the figure. I was not able to find steady states with $Rm$ greater than those shown due to the stronger flow being unstable, possibly due to the temperature singularity at the chimney edge. The change in behaviour occurs when the flow entering the chimney becomes sufficiently strong to force the cold thermal boundary layer in the mush closer to the chimney, causing freezing at the chimney edge and therefore decreasing its width. 

The approximately linear relationship between $F/R$ and $Rm$ agrees with the results of~\citet*{rees-jones-worster-13} in axisymmetry for large $Rm$. Their analysis also shows that, for smaller $Rm$, the solute flux exhibits a nonlinear dependence on $Rm$. This is in contrast to the planar geometry where, in the limit $\CompRatio \gg 1$, the relationship is linear for all $Rm$~\citep*{wells-et-al-13}. However, despite significant effort, it was not possible to resolve states with a lower $Rm$ than those shown. The limiting factor was the relaxation scheme used to determine $a$, which became unstable as the flow strength, and hence the chimney width, became small.

Curves are plotted for three different convection cell drainage areas $R^2$ (omitting the factor of $\pi$) which reveals that as $Rm$ increases the drainage area which maximises solute flux decreases, an observation illustrated more clearly in figure~\ref{subfig:R-plot}. Here, both the $R$-averaged flux and the flux per chimney has been plotted. The latter increases monotonically with $R$, as increasing the radius of the cell also increases the size of the thermal boundary layer in which baroclinic torque is produced, driving a greater flow. On the other hand the average flux, whilst initially increasing with $R$, has a maximum value at a critical radius $R_c(Rm)$ above which it decreases. This feature is well observed in both planar and axisymmetric geometries. In axisymmetry, at lower Rayleigh numbers ($Rm \sim 15$), the model developed by~\citet*{rees-jones-worster-13} predicts the existence of two distinct maxima however, due to numerical instabilities already mentioned, I have been unable to reach this region of parameter space. 

%However the horizontal temperature gradient decreases as $R$ is increased, which reduces the size of the torque produced at each point within the boundary layer and means that whilst the flux increases, it does so more slowly at larger $R$.
\begin{comment}
  \begin{figure*}[ht!]
\centering
\begin{subfigure}[t]{.48\linewidth}
    \centering
    %\includegraphics[width=\textwidth]{Rm-a-H0-25R0-34}
    \setlength\figureheight{5cm} 
	\setlength\figurewidth{8cm}
	\caption{}
	\input{DRJ-comparison.tikz} 
    \label{subfig:DRJ-comparison}
 \end{subfigure}
 \quad
 \begin{subfigure}[t]{.48\linewidth}
    \centering
        %\includegraphics[width=\textwidth]{Rm-a-H0-25R0-34}
    \setlength\figureheight{5cm} 
	\setlength\figurewidth{2cm}
	\caption{}
	\input{DRJ-comparison-cross-section.tikz} 
    \label{subfig:DRJ-comparison-cross-section}
 \end{subfigure}
 
 \caption{~\subref{subfig:DRJ-comparison} Deviation from linear temperature field, $\delta = \int \Delta \theta \; dz$, at $r=R$ plotted over a range of $Rm$ for fixed $\theta_\infty = 1.4, Da = 5\times10^{-5}$.~\subref{subfig:DRJ-comparison-cross-section} a typical example of the spatial distribution of the deviation from a linear field $\Delta \theta = \theta - (-1-z/H)$.}
 \label{fig:parameter-plots}
 \end{figure*}
 \end{comment}

Whilst it has not been possible to explore the regions of parameter space needed to make a complete comparison of this model with that of~\citet*{rees-jones-worster-13}, it is still possible to test the validity of one of their key simplifying assumptions. Away from the chimney, they assume the mushy layer is `passive': the temperature field is linear in the vertical direction and radially constant, therefore generating no baroclinic torque. Using my numerical model I am able to quantify the deviation from a vertically linear field at $r=R$ by calculating $ \delta_\theta = \left[\theta - (-1-z/H)\right] / \theta$. For the subset of parameters that I have been able to investigate, as illustrated in figure~\ref{fig:parameter-plots}, I find that $ 0.09 < \overline{ \delta_\theta} < 0.11 $. Crucially, the parameter dependence of this result is weak so I expect it to be roughly applicable to the lower $Rm$ flow modelled by Rees Jones and Worster. Therefore my model predicts a temperature field in the passive region which differs from their approximation by $\sim10\%$. Whilst this seems significant, it is worth noting that it is the area near the chimney which drives the flow, not the appropriately named passive region, so a $10\%$ effect on the temperature field at $r=R$ should not correspond to a similarly large effect on quantities such as the solute flux out of the mushy layer.

\begin{comment}
where studies by previous authors suggest there should exist a set of unstable states forming the lower branch of a saddle point bifurcation~\citep*{schulze-worster-98,chung-worster-02}. Instead, the numerical method jumps to steady states with no chimney, $a=0$, which are not of interest. [Need to make more of an effort to see if I can get to the lower branch by reducing $Rm$ in smaller steps or decreasing $\Delta r$ before deciding it's impossible and offering possible explanations for why the model cannot get to it].
\end{comment}


\section{Conclusion}
\label{sec:conclusion}
I have derived and solved a numerical model for states of steady convection in an axisymmetric ideal mushy layer. Cylindrical convection cells of radius $R$ were considered, centred on a liquid chimney of radius $a$. By deriving a novel set of boundary conditions I avoided the computationally intensive problem of solving for the fluid flow in the ocean and the chimney. The governing equations within the mushy layer were simplified through a catalogue of assumptions which, most importantly, removed the dependence on permeability and decoupled the equations for conservation of heat and solute. Meanwhile the geometry was simplified by the assumption that the convection cell has straight edges. The free boundary problem for the chimney wall was solved using relaxation based on the condition of marginal equilibrium derived by~\citet*{schulze-worster-99}. In contrast to previous studies I did not include the chimney wall in my iteration grid, instead using analytically derived equations to extrapolate from the numerical solution on the grid to the chimney in order to implement the relaxation method. This avoided having to remap the domain at each timestep, saving considerable computing power. The mush-ocean interface was also treated in a new way. Instead of fixing $\theta_\infty$ and relaxing $H$ to satisfy the boundary condition~\eqref{eq:mush-ocean-bc} as previous authors did, I fixed $H$, greatly improving the numerical stability, and subsequently calculated $\theta_\infty$ for each steady state. Empirical observations were then used to choose values of $H$ which gave the required $\theta_\infty$.

Solutions to the model revealed that baroclinic torque, produced in a thermal boundary layer next to the chimney, is the driving force behind convection in the mushy layer. The temperature singularity at $(a,-H)$, introduced by imposing a flat mush-ocean boundary, was seen to have a large but, crucially, localised effect. The parameter dependence of the average solute flux and chimney width was studied, revealing a critical radius $R_c(Rm)$ at which the solute flux was maximised and a critical Rayleigh number $Rm_c(R)$ below which the flow was insufficiently strong to sustain liquid chimneys. These results are in agreement with the axisymmetric model developed by~\citet*{rees-jones-worster-13}, and also match observations in planar geometry~\citet*{wells-et-al-13}. The behaviour of these two different geometries is expected to differ at lower $Rm$, however I was not able to reach this region of parameter space due to the weaker flow causing numerical instabilities in the determination of the chimney radius.

Although direct comparison with the results of~\citet*{rees-jones-worster-13} could not be achieved, it was possible to test the validity of their assumption that the temperature field at $r=R$ is linear in $z$. Calculations revealed that, across a broad range of $Rm$ and $R$, the average fractional deviation from a linear field is $\sim10\%$. Whilst this is notable, the weak dependence of the flow on the temperature gradient in the passive region means that their approximation should not significantly  affect the steady state solute fluxes predicted by their model.

The results presented here are a first attempt at numerically modelling mushy layer convection with chimneys in axisymmetry, and there is considerable scope to extend this work. With the current model, further parameter dependence could be investigated;~\citet*{rees-jones-worster-13} showed that the solute flux depends strongly on $Da$ in axisymmetry but not in planar geometry, so it would be interesting to observe the response of this model to a changing Darcy number. To fully test the predictions of the theoretical model developed by~\citet*{rees-jones-worster-13}, steady states must be found at lower values of the Rayleigh number than are possible at present. Therefore the most important development that can be made to this model is the implementation of a more stable method for determining the chimney radius. It would also be desirable to resolve the shape of the chimney boundary, $a=a(z)$, and the current treatment of the chimney provides a natural way to do this whilst avoiding the problems which arise from having an irregularly spaced grid. However first the temperature singularity must be removed, as it would prevent accurate estimation of $a$ at the point where the chimney meets the ocean. To do this, it would be necessary to apply a functional form for $H = H(r)$ that satisfies the boundary conditions on $\theta$, as~\citet*{schulze-worster-98} did in a planar geometry. Through these changes it should be possible to conduct a thorough test of the parametrizations already suggested in axisymmetry, allowing them to be incorporated in large scale circulation models with greater confidence.

\onecolumn
\bibliography{references}{}








%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%             Appendix         %%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\titleformat{\section}{\normalfont\Large\bfseries}{\appendixname~\thesection.}{1em}{}
\begin{appendices}

\label{appendix}
\numberwithin{equation}{section}


  \section{Numerical method}
\label{app:numerical-method}
An Alternating Direction Implicit (ADI) scheme is used to solve the heat equation~\eqref{eq:heat-psi}. This involves first discretizing temporally (time indices are denoted by superscripts),
\begin{equation}
r  \frac{\theta^{n+1/2} - \theta^n}{\Delta t / 2} = \left[ (r \theta_r)_r + r \theta_{zz} - r \theta_z + \psi^n_z \theta_r - \psi^n_r \theta_z \right] \left( \theta^{n+1/2} + \theta^n \right),
\end{equation}
and splitting this into two equations, each implicit in one spatial direction and explicit in the other;
\begin{eqnarray}
r \frac{\theta^{n+1/4} - \theta^n}{\Delta t / 4} &=& \left(  r \partial_{zz} -  \psi_r^n \partial_z - r \partial_z   \right) \theta^{n+1/4} + \left(  \partial_r (r \partial_r) +   \psi_z^n \partial_r    \right) \theta^{n} \; ;  \\
r \frac{\theta^{n+1/2} - \theta^{n+1/4}}{\Delta t / 4} &=&\left(  r \partial_{zz} -  \psi_r^n \partial_z - r \partial_z   \right) \theta^{n+1/4}   +   \left(  \partial_r (r \partial_r) +   \psi_z^{n+1/4} \partial_r    \right) \theta^{n+1/2}  \;   .   
\end{eqnarray}
Re-arranging this gives two equations which are solved sequentially to proceed from a timestep $n$ to another $n+1/2$.
\begin{eqnarray}
\left( 1 - \frac{\Delta t}{4} (\partial_{zz}-\partial_z) + \frac{\Delta t \psi_r}{4 r} \partial_z \right) \theta^{n+1/4} &=& \left(1 + \frac{\Delta t}{4 r} \partial_r (r \partial_r) + \frac{\Delta t \psi_z}{4 r} \partial_r \right) \theta^n  ; \label{eq:theta-ADI1}\\
\left(1 - \frac{\Delta t}{4 r} \partial_r (r \partial_r) - \frac{\Delta t \psi_z}{4 r} \partial_r \right) \theta^{n+1/2} &=& \left( 1 + \frac{\Delta t}{4} (\partial_{zz}-\partial_z) - \frac{\Delta t \psi_r}{4 r} \partial_z \right) \theta^{n+1/4}  .  \label{eq:theta-ADI2}
\end{eqnarray}
The spatial derivatives are discretized using standard second order finite differences, with a slight subtlety for the flux term where, in order to better match fluxes entering and leaving a grid point, I use
\begin{equation}
(r \theta_r)_r \approx \frac{(r \theta_r)_{i+1/2, j} - (r \theta_r)_{i-1/2,j}}{ \Delta r} \approx \frac{1}{(\Delta r)^2} \left[ r_{i+1/2} \left( \theta_{i+1, j} - \theta_{i, j} \right) - r_{i-1/2} \left( \theta_{i, j} - \theta_{i-1, j} \right)\right].
\end{equation}
The vorticity equation is solved by iteration with successive over relaxation:
\begin{multline}
\label{eq:psi-SOR}
  \psi^n_{i,j} = (1-w) \psi_{i,j}^{n-\frac{1}{2}} + w \frac{r_i}{2 \left( \frac{1}{(\Delta z)^2} + \frac{1}{(\Delta r)^2}\right)} \left[  R_m  \frac{\theta^{n-1/2}_{i+1, j} - \theta^{n-1/2}_{i-1, j}}{2 \Delta r} + \left(\frac{1}{r_i (\Delta r)^2} - \frac{1}{2 r_i^2 \Delta r} \right) \psi^{n-\frac{1}{2}}_{i+1, j}           \right.   \\ +   \left.             
                 \left(\frac{1}{r_i (\Delta r)^2} + \frac{1}{2 r_i^2 \Delta r} \right) \psi^{n-\frac{1}{2}}_{i-1, j} + \frac{1}{r_i (\Delta z)^2} \left(\psi^{n-\frac{1}{2}}_{i,j-1} + \psi^{n-\frac{1}{2}}_{i, j+1} \right)                         \right]  .
\end{multline}
The heat and vorticity equations are coupled through $\psi$, so care must be taken when solving them together. I follow the approach of~\citet*{hewitt-14} and, starting from an initial $\psi^n$ and $\theta^n$, calculate the fields at a timestep $n+1$ by
\begin{enumerate}
	\item Calculate $\theta^{n+1/2}$ using $\theta^n, \psi^n$ and equations~\eqref{eq:theta-ADI1},~\eqref{eq:theta-ADI2}
	\item Calculate $\psi^{n+1/2}$ using $\theta^{n+1/2}, \psi^n$ and equation~\eqref{eq:psi-SOR}
	\item Calculate $\theta^{n+1}$ using $\theta^n, \psi^{n+1/2}$ and equations~\eqref{eq:theta-ADI1},~\eqref{eq:theta-ADI2}
	\item Calculate $\psi^{n+1}$ using $\theta^{n+1}, \psi^n$ and equation~\eqref{eq:psi-SOR}
\end{enumerate}



  \section{Solute flux} \label{app:solute-flux}
Due to the coupling of temperature and solute concentration, $\theta=-\Theta$, the heat flux into the mushy layer is equal to the solute flux out of it. Therefore the solute flux through a surface can be calculated by considering the heat flux through the same surface. Of most interest is the solute flux from them mushy layer to the chimney, or equivalently the heat flux from the chimney to the mushy layer:
\begin{equation}
F = \iint_S \left[ \mathbf{q} \, \theta - \nabla \theta \right] \cdot \mathbf{\hat{n}} \; dS,
\end{equation}
and the mush-chimney surface is defined by $\mathbf{\hat{n}} = \mathbf{\hat{r}} \; (0 < z < H) $. However, what is of interest is not the flux through one chimney but that through a region consisting of many chimneys. The number of chimneys that can be contained in a region is inversely proportional to their radius, $R$, so I instead consider
 \begin{equation}
F/R = \frac{1}{R} \frac{1}{2 \pi a H} \int_{z=0}^{-H} \left( \mathbf{q}.\mathbf{n} \, \theta + \frac{\partial \theta}{\partial z} \right) 2 \pi a \; dz \hspace{5ex} (r=a),
\end{equation}
where the values of $\theta$ and $\psi$ at $r=a$ are calculated using their values at $r=b$ and the analytical patching equations (see section~\ref{sec:patching-equations}). The integral is then evaluated numerically using the MATLAB function \texttt{trapz}.












\begin{comment}
The heat equation can be written
\begin{equation}
\frac{\partial \theta}{\partial t} + \nabla \cdot \left[ \mathbf{q} \theta - \nabla \theta \right] = 0.
\end{equation}
In steady state, using the divergence theorem,
\begin{equation}
\int_V \nabla \cdot \left[ \mathbf{q} \theta - \nabla \theta \right] dV = \oiint_S \left[ \mathbf{q} \theta - \nabla \theta \right] \cdot \mathbf{\hat{n}} \; dS = 0,
\end{equation}
so that the net heat fluxes out of the convection cell balance. Furthermore, the boundary conditions ensure there is no heat flux from $r=0, R$. Therefore
\begin{equation}
F_{ms} + F_{mc} + F_{mo} = 0,
\end{equation}
where $F_{ms}$ is the heat flux from mush to solid, $F_{mc}$ is the heat flux from mush to chimney and $F_{mo}$ is the heat flux from mush to ocean. As $\theta=-\Theta$ in the mushy layer, heat fluxes and solute fluxes and equal but opposite in sign. I will calculate the heat flux through the mush-solid boundary $F_{mo}$, and therefore also the solute flux from the mushy layer into the liquid ($F_{mc} + F_{mo}$).
\begin{equation}
F_{ms} = \frac{1}{\pi (R^2-a^2)} \int_{r=a}^R \left( \mathbf{q}.\mathbf{n} \, \theta + \frac{\partial \theta}{\partial z} \right) 2 \pi r \; dr \hspace{5ex} (z=0)
\end{equation}
There is no normal flow at this boundary ($\mathbf{u}\cdot\mathbf{n}$), $\theta=-1$ and $\mathbf{n} = \mathbf{\hat{z}}$. For $r<b$, I use the approximation $\left. \theta_z \right|_{r<b} = \left. \theta_z \right|_{r=b}$. Therefore
\begin{equation}
F_{ms} = - 1  + \frac{b^2-a^2}{R^2-a^2}  \left.  \frac{\partial \theta}{\partial z} \right|_{r=b} + \frac{1}{\pi (R^2-a^2)} \int_{r=b}^R  \frac{\partial \theta}{\partial z}  2 \pi r \; dr \hspace{5ex} (z=0).
\end{equation}

\begin{equation}
F =  \frac{1}{\pi (R^2-a^2)} \int_{r=a}^R \left.\left( \mathbf{q}.\mathbf{n} \, \theta + \frac{\partial \theta}{\partial z} \right)\right|_{z=0} 2 \pi r \; dr .
\end{equation}

\end{comment}




\begin{comment}
\subsection{Mush-chimney boundary}
\begin{equation}
F_{mc} = \frac{1}{2 \pi a H} \int_{z=0}^{-H} \left( \mathbf{q}.\mathbf{n}  \,\theta + \frac{\partial \theta}{\partial z} \right) 2 \pi a \; dz \hspace{5ex} (r=a).
\end{equation}
 $\mathbf{n} = \mathbf{\hat{z}}$ so $\mathbf{q}.\mathbf{n} = \mathbf{u}.\mathbf{n}$, but no further simplifications can be made so I have
 \begin{equation}
F_{mc} = \frac{1}{2 \pi a H} \int_{z=0}^{-H} \left( \mathbf{u}.\mathbf{n} \, \theta + \frac{\partial \theta}{\partial z} \right) 2 \pi a \; dz \hspace{5ex} (r=a).
\end{equation}
\end{comment}



\end{appendices}

\end{document}